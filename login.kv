#: include flashcards.kv
#: include stolb.kv
#: include lesson_one.kv
#: include audio.kv
#: include lesson_two.kv
#: include lesson_three.kv
#: include lesson_four.kv
#: include lesson_five.kv
#: include lesson_six.kv
#: include lesson_seven.kv
#: include lesson_eight.kv
#: include lesson_nine.kv

<LabelP@Label>
    id: p1
    markup: True
    size_hint: 0.2, 0.07
    font_size:30
    color: 0,0,0,1
<TextInputO@TextInput>
    multiline: False
    input_filter: "int"
    focus: True
    font_size: 24
    text: ''
    halign: 'center'
    size_hint: 0.1, 0.07
<ImageYN@Image>
    size_hint: 0.06, 0.06
    markup: True
<MyPopup@Popup>:
    auto_dismiss: False
    Button:
        text: 'Close me!'
        on_release: root.dismiss()

<Kost@ImageButton>:
    source:  "Image/kost.png"
    size_hint: 0.15, 0.1
    allow_stretch: True
    keep_ratio: False

<ImageContext@Image>:
    size_hint: 1.2, 1.2
    pos_hint: {'x': -0.1, 'y': -0.1}
    allow_stretch: True #image in fullscreen
    keep_ratio: False

<ButtonAnswer@Button>:
    font_size: 20
    background_normal: ''
    background_color: 1, .80, .4, .85
    color: 0,0,0,.7

<ButtonMain@ImageButton>:
    size_hint: 0.25, 0.1
    allow_stretch: True #image full the button
    keep_ratio: False #image full the button

<ButtonAnswerP@ImageButton>:
    size_hint: 0.1, 1
    allow_stretch: True #image full the button
    keep_ratio: False #image full the button

<ButtonIcon@ImageButton>:
    size_hint: 0.1, 0.1
    allow_stretch: True #image full the button
    keep_ratio: False #image full the button

<ButtonUrok@Button>:
    font_size: 20
    background_normal: ''
    background_color: 1, .80, .4, .85
    color: 0,0,0,.7

<LabelUp@Label>
    canvas.before:
        Color:
            rgba: 255,205,0,255
        Rectangle:
            pos: self.pos
            size: self.size

    color: 1, 0, 1, 1
    size_hint: 0.2, 0.07

<Prodol>
    auto_dismiss: False
    size_hint: None, None
    size: 400,200
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: rez
        BoxLayout:
            orientation: 'horizontal'
            Button:
                id: bk
                on_press:
                    app.root.transition.direction = 'right'
                    app.root.current = 'mainscreen'
                    root.reshat()
            Button:
                id: pr
                on_release: root.reshat()


Button:
    text: 'Open popup'
    on_release: Factory.MyPopup().open()

<First>:
    FloatLayout:
        Image:
            source: "Image/Main.jpg"
            size_hint: 1.2, 1.2
            pos_hint: {'x': -0.1, 'y': -0.1}
            allow_stretch: True #image in fullscreen
            keep_ratio: False
        MDFillRoundFlatButton:
            id: button_input
            font_size: 20
            size_hint: 0.25, 0.1
            text_color: 0, 0, 1, 1
            pos_hint: {'x': 0.38, 'y': 0.68}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'login'
        MDFillRoundFlatButton:
            id: Register
            font_size: 20
            text_color: 0, 0, 1, 1
            size_hint: 0.25, 0.1
            pos_hint: {'x': 0.38, 'y': 0.48}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'registration'


<Registration>
    FloatLayout:
        Image:
            source: "Image/Registr.jpg"
            size_hint: 1.2, 1.2
            pos_hint: {'x': -0.1, 'y': -0.1}
            allow_stretch: True #image in fullscreen
            keep_ratio: False
        BoxLayout
            id: Registration_layout
            orientation: 'vertical'
            padding: [10,50,10,50]
            spacing: 50

            Label:
                id: registration
                font_name : 'Font/Zagolovki.otf'
                font_size: 60

            BoxLayout:
                orientation: 'vertical'

                MDLabel:
                    id: login_label
                    font_size: 18
                    pos_hint: {'x': 0.3, 'y': 0.7}
                    halign: 'left'
                    text_size: root.width-20, 20
                    color: [1,1,1,1]

                MDTextFieldRound:
                    id: login
                    icon_right: "account"
                    size_hint: 0.4, 1.5
                    pos_hint: {'x': 0.3, 'y': 0.78}
                    multiline:False
                    font_size: 18
                    color_active: [1,1,1,1]

            BoxLayout:
                orientation: 'vertical'
                MDLabel:
                    id: password_label
                    halign: 'left'
                    pos_hint: {'x': 0.3, 'y': 0.5}
                    font_size: 18
                    text_size: root.width-20, 20
                    color: [1,1,1,1]

                MDTextFieldRound:
                    id: password_one
                    icon_right: "eye-off"
                    size_hint: 0.4, 1.5
                    pos_hint: {'x': 0.3, 'y': 0.58}
                    multiline:False
                    password:True
                    font_size: 18
                    color_active: [1,1,1,1]

            BoxLayout:
                orientation: 'vertical'

                MDLabel:
                    id: password_repeat
                    color: [1,1,1,1]
                    font_size: 18
                    pos_hint: {'x': 0.3, 'y': 0.3}
                    halign: 'left'
                    text_size: root.width-20, 20

                MDTextFieldRound:
                    id: password_rep
                    icon_right: "eye-off"
                    size_hint: 0.4, 1.5
                    pos_hint: {'x': 0.3, 'y': 0.38}
                    multiline:False
                    password:True
                    font_size: 18
                    color_active: [1,1,1,1]


            MDFillRoundFlatButton:
                id: registration_button
                #text: 'Registration'
                font_size: 24
                size_hint: 0.4, 1
                pos_hint: {'x': 0.3, 'y': 0.28}
                background_normal: ''
                background_color: 1, .80, .4, .85
                color: 0,0,0,.7
                on_press:
                    root.insert_user(login.text, password_one.text, password_rep.text)
                    root.resetForm()
    MDIconButton:
        id: exit_first
        icon: 'arrow-left-thick'
        user_font_size: "48sp"
        pos_hint: {'x': 0.01, 'y': 0.87}
        on_press:
            root.manager.transition.direction = 'right'
            root.manager.current = 'first'
            root.resetForm()

<Login>:
    FloatLayout:
        Image:
            source: "Image/Registr.jpg"
            size_hint: 1.2, 1.2
            pos_hint: {'x': -0.1, 'y': -0.1}
            allow_stretch: True #image in fullscreen
            keep_ratio: False
        BoxLayout:
            id: login_layout
            orientation: 'vertical'
            padding: [10,50,10,50]
            spacing: 50

            Label:
                id: welcome
                font_name : 'Font/Zagolovki.otf'
                font_size: 60

            BoxLayout:
                orientation: 'vertical'

                MDLabel:
                    id: login_name
                    color: [1,1,1,1]
                    font_size: 21
                    pos_hint: {'x': 0.3, 'y': 0.9}
                    halign: 'left'
                    text_size: root.width-20, 20

                MDTextFieldRound:
                    id: login
                    icon_right: "account"
                    multiline:False
                    font_size: 23
                    size_hint: 0.4, 0.9
                    pos_hint: {'x': 0.3, 'y': 0.98}
                    color_active: [1,1,1,1]

            BoxLayout:
                orientation: 'vertical'
                MDLabel:
                    id: login_password
                    #text: 'Password'
                    halign: 'left'
                    font_size: 21
                    color: [1,1,1,1]
                    pos_hint: {'x': 0.3, 'y': 0.5}
                    text_size: root.width-20, 20

                MDTextFieldRound:
                    id: password_text
                    icon_right: "eye-off"
                    multiline:False
                    password:True
                    size_hint: 0.4, 0.9
                    pos_hint: {'x': 0.3, 'y': 0.58}
                    font_size: 23
                    color_active: [1,1,1,1]

            MDFillRoundFlatButton:
                id: connection
                font_size: 24
                size_hint: 0.4, 0.7
                pos_hint: {'x': 0.3, 'y': 0.38}
                on_press:
                    root.do_login(login.text, password_text.text)
                    root.resetForm()

        MDIconButton:
            id: exit_first
            icon: 'arrow-left-thick'
            user_font_size: "48sp"
            pos_hint: {'x': 0.01, 'y': 0.87}
            on_press:
                root.manager.transition.direction = 'right'
                root.manager.current = 'first'
                root.resetForm()

<MainScreen>:
    FloatLayout:
        ImageContext:
            source: "Image/MainScreen.jpg"
        BoxLayout:
            id: main
            orientation: 'horizontal'
            padding: [10,-50,10,10]
            spacing: 20
            BoxLayout:
                id: main_urok
                orientation: 'vertical'
                padding: [10,0,10,20]
                spacing: 5
                BoxLayout:
                    id: main
                    orientation: 'vertical'
                    padding: [10,0,10,10]
                    spacing: 5
                    Label:
                        id: uroki
                        markup: True
                        font_name : 'Font/Zagolovki.otf'
                        font_size: 80
                    Button:
                        id: btvvod
                        font_size: 24
                        size_hint: 1, 0.3
                        pos_hint: {'x': 0, 'y': 0.9}
                        background_normal: ''
                        background_color: 1, .80, .4, .85
                        color: 0,0,0,.7
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'introductory_lesson'
                GridLayout:
                    rows: 4
                    cols: 3
                    padding: [10,0,10,10]
                    spacing: 5
                    ButtonUrok:
                        id: urok1
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_one'
                    ButtonUrok:
                        id: urok2
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_two'
                    ButtonUrok:
                        id: urok3
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_three'
                    ButtonUrok:
                        id: urok4
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_four'
                    ButtonUrok:
                        id: urok5
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_five'
                    ButtonUrok:
                        id: urok6
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_six'
                    ButtonUrok:
                        id: urok7
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_seven'
                    ButtonUrok:
                        id: urok8
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_eight'
                    ButtonUrok:
                        id: urok9
                        on_press:
                            root.manager.transition.direction = 'left'
                            root.manager.current = 'lesson_nine'

                Button:
                    id: soroban
                    font_size: 24
                    size_hint: 0.96, 0.3
                    pos_hint: {'x': 0.02, 'y': 0.9}
                    background_normal: ''
                    background_color: 1, .80, .4, .85
                    color: 0,0,0,.7
                    on_press:
                        root.manager.transition.direction = 'left'
                        root.manager.current = 'soroban'



            BoxLayout:
                id: main_trenajor
                orientation: 'vertical'
                padding: [10,0,10,50]
                spacing: 50
                Label:
                    id: trenajor
                    markup: True
                    pos_hint: {'x': 0.01, 'y': 0.1}
                    font_name : 'Font/Zagolovki.otf'
                    font_size: 80
                Button:
                    id: tren_stolb
                    font_size: 24
                    size_hint: 1, 0.3
                    pos_hint: {'x': 0, 'y': 0.9}
                    background_normal: ''
                    background_color: 1, .80, .4, .85
                    color: 0,0,0,.7
                    on_press:
                        root.manager.transition.direction = 'left'
                        root.manager.current = 'stolb'
                Button:
                    id: tren_flesh
                    font_size: 24
                    size_hint: 1, 0.3
                    pos_hint: {'x': 0, 'y': 0.9}
                    background_normal: ''
                    background_color: 1, .80, .4, .85
                    color: 0,0,0,.7
                    on_press:
                        root.manager.transition.direction = 'left'
                        root.manager.current = 'flashcards'
                Button:
                    id: tren_audio
                    font_size: 24
                    size_hint: 1, 0.3
                    pos_hint: {'x': 0, 'y': 0.9}
                    background_normal: ''
                    background_color: 1, .80, .4, .85
                    color: 0,0,0,.7
                    on_press:
                        root.manager.transition.direction = 'left'
                        root.manager.current = 'audio_tren'


        MDFlatButton:
            id: bn
            pos_hint: {'x': 0.88, 'y': 0.94}
            size_hint: 0.1, 0.05
            text_color: 0,0,0,1
            md_bg_color: 0, 0, 1, 0.25
            on_press:
                root.exit_func()
                app.stop()
        MDFlatButton:
            id: bn_clear
            pos_hint: {'x': 0.05, 'y': 0.94}
            size_hint: 0.1, 0.05
            text_color: 0,0,0,1
            md_bg_color: 0, 0, 1, 0.25
            on_press:
                root.show_alert_dialog()

    MDIcon:
        icon: "account"
        pos_hint: {'x': 0.67, 'y': 0.47}

    MDLabel:
        id: urok_bd
        font_size: 15
        pos_hint: {'x': 0.15, 'y': 0.32}

    MDLabel:
        id: progress_bd
        font_size: 15
        pos_hint: {'x': 0.58, 'y': 0.2}


    MDLabel:
        id: user_name
        pos_hint: {'x': 0.73, 'y': 0.47}
        background_normal: ''
        background_color: 1, .80, .4, .85
        color: 0,0,0,.7
        font_size: 23



<Soroban>:
    FloatLayout:
        Image:
            source: "Image/VvodUrok.png"
            allow_stretch: True
            keep_ratio: False
        MDIconButton:
            id: exit_first
            icon: 'arrow-left-thick'
            user_font_size: "48sp"
            pos_hint: {'x': 0.01, 'y': 0.87}
            on_press:
                root.manager.transition.direction = 'right'
                root.manager.current = 'mainscreen'
        Image:
            source: "Image/line.png"
            size_hint: 0.25, 0.3
            pos_hint: {'x': .65, 'y': 0.54}
        Image:
            source: "Image/line.png"
            size_hint: 0.25, 0.3
            pos_hint: {'x': .5, 'y': 0.54}
        Image:
            source: "Image/line.png"
            size_hint: 0.25, 0.3
            pos_hint: {'x': .65, 'y': 0.759}
        Image:
            source: "Image/line.png"
            size_hint: 0.25, 0.3
            pos_hint: {'x': .5, 'y': 0.759}
        Label:
            id: lb
            font_size: 100
            text: '0'
            color: 1,1,0,1
            pos_hint: {'x': 0.27,'y': -0.4}
        Label:
            id: lb_1
            font_size: 100
            text: '0'
            color: 1,1,0,1
            pos_hint: {'x': 0.1,'y': -0.4}
        Label:
            id: text_lb
            font_size: 25
            color: 1,1,0,1
            pos_hint: {'x': -0.26,'y': 0.35}
        TextInput:
            id: txt
            multiline: False
            input_filter: "int"
            focus: True
            font_size: 130
            text: ''
            size_hint: 0.16, 0.19
            pos_hint: {'x': 0.1,'y': 0.5}
            on_text_validate:
                root.number()
                root.validate()
        Kost:
            id: k5
            pos_hint: {'x': .7, 'y': 0.8}
            on_press: root.fun5(1)
        Kost:
            id: k6
            pos_hint: {'x': .7, 'y': 0.7}
            size_hint: 0, 0
            on_press: root.fun6(1)
        Kost:
            id: k7
            pos_hint: {'x': .7, 'y': 0.58}
            size_hint: 0, 0
            on_press: root.fun7(1)
        Kost:
            id: k1
            pos_hint: {'x': .7, 'y': 0.48}
            on_press: root.fun1(1)
        Kost:
            id: k2
            pos_hint: {'x': .7, 'y': 0.38}
            on_press: root.fun2(1)
        Kost:
            id: k3
            pos_hint: {'x': .7, 'y': 0.28}
            on_press: root.fun3(1)
        Kost:
            id: k4
            pos_hint: {'x': .7, 'y': 0.18}
            on_press: root.fun4(1)

        Kost:
            id: k5_1
            pos_hint: {'x': .53, 'y': 0.8}
            on_press: root.fun5(2)
        Kost:
            id: k6_1
            pos_hint: {'x': .53, 'y': 0.7}
            size_hint: 0, 0
            on_press: root.fun6(2)
        Kost:
            id: k7_1
            pos_hint: {'x': .53, 'y': 0.58}
            size_hint: 0, 0
            on_press: root.fun7(2)
        Kost:
            id: k1_1
            pos_hint: {'x': .53, 'y': 0.48}
            on_press: root.fun1(2)
        Kost:
            id: k2_1
            pos_hint: {'x': .53, 'y': 0.38}
            on_press: root.fun2(2)
        Kost:
            id: k3_1
            pos_hint: {'x': .53, 'y': 0.28}
            on_press: root.fun3(2)
        Kost:
            id: k4_1
            pos_hint: {'x': .53, 'y': 0.18}
            on_press: root.fun4(2)



<Introductory_lesson>:
    BoxLayout:
        orientation:'vertical'
        MDToolbar:
            id : toolbar
            type: "top"
            md_bg_color: .2, .2, .2, 1
            specific_text_color: 1, 1, 1, 1
            MDRoundFlatButton:
                id: exit
                pos_hint: {"center_x": .9, "center_y": .54}
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'mainscreen'
                    root.stop()

        MDBottomNavigation:
            panel_color: .2, .2, .2, 1

            MDBottomNavigationItem:
                id: theory
                name: 'screen 1'
                icon: 'teach'
                Screen:
                    id: screen_vvod
                    BoxLayout:
                        orientation: 'vertical'
                        MDLabel:
                            id: textvvod
                            text_size: self.size
                            pos_hint: {'x': 0.01, 'y': 0.75}
                            halign: 'center'
                            valign: 'middle'
                        Image:
                            source: "Image/Soroban.jpg"
                            size_hint: 0.3, 0.7
                            pos_hint: {'x': 0.35, 'y': -0.1}

                    MDIconButton:
                        id: button_sound
                        icon:  "volume-high"
                        user_font_size: "26sp"
                        pos_hint: {'x': 0.9, 'y': 0.9}
                        on_press:
                            root.play_sound()

            MDBottomNavigationItem:
                id: zadania
                name: 'screen 2'
                icon: 'note'
                Screen:
                    id: screen_1
                    name: 'Screen one'  # имя экрана
                    BoxLayout:
                        orientation: 'vertical'
                        padding: [10,0,10,50]
                        spacing: 50
                        Label:
                            id: ques1
                            markup: True
                            pos_hint: {'x': 0.01, 'y': 0.45}
                            font_size: 40
                        BoxLayout:
                            orientation: 'horizontal'
                            padding: [10,0,10,50]
                            spacing: 50
                            ButtonAnswer:
                                text: '6'
                                on_press: root.answer1_pressed()

                            ButtonAnswer:
                                text: '2'
                                on_press: root.answer2_pressed()

                            ButtonAnswer:
                                text: '5'
                                on_press: root.answer3_pressed()

                            ButtonAnswer:
                                text: '1'
                                on_press: root.answer4_pressed()

                        Button:
                            id: propusk1
                            size_hint: 1, 0.3
                            on_press: root.propusk()

                Screen:
                    id: screen_2
                    name: 'Screen two'
                    opacity: 0
                    BoxLayout:
                        orientation: 'vertical'
                        padding: [10,0,10,50]
                        spacing: 50
                        Label:
                            id: ques2
                            markup: True
                            pos_hint: {'x': 0.01, 'y': 0.45}
                            font_size: 40
                        BoxLayout:
                            orientation: 'horizontal'
                            padding: [10,0,10,50]
                            spacing: 50
                            ButtonAnswer:
                                text: '6'
                                on_press: root.answer1_pressed()

                            ButtonAnswer:
                                text: '2'
                                on_press: root.answer2_pressed()

                            ButtonAnswer:
                                text: '5'
                                on_press: root.answer3_pressed()

                            ButtonAnswer:
                                text: '1'
                                on_press: root.answer4_pressed()

                        Button:
                            id: propusk2
                            size_hint: 1, 0.3
                            on_press: root.propusk()
                Screen:
                    id: screen_3
                    name: 'Screen three'
                    opacity: 0
                    BoxLayout:
                        orientation: 'vertical'
                        padding: [10,0,10,50]
                        spacing: 50
                        Label:
                            id: ques3
                            markup: True
                            pos_hint: {'x': 0.01, 'y': 0.45}
                            font_size: 27
                        BoxLayout:
                            orientation: 'horizontal'
                            padding: [10,0,10,50]
                            spacing: 50
                            ButtonAnswer:
                                id: answer1
                                on_press: root.answer1_pressed()

                            ButtonAnswer:
                                id: answer2
                                on_press: root.answer2_pressed()

                            ButtonAnswer:
                                id: answer3
                                on_press: root.answer3_pressed()

                            ButtonAnswer:
                                id: answer4
                                on_press: root.answer4_pressed()
                        Button:
                            id: propusk3
                            size_hint: 1, 0.3
                            on_press: root.propusk()
                Screen:
                    id: screen_4
                    name: 'Screen four'
                    opacity: 0
                    BoxLayout:
                        orientation: 'vertical'
                        padding: [10,0,10,50]
                        spacing: 50
                        Label:
                            id: ques4
                            markup: True
                            pos_hint: {'x': 0.01, 'y': 0.45}
                            font_size: 27
                        BoxLayout:
                            orientation: 'horizontal'
                            padding: [10,0,10,50]
                            spacing: 50
                            ButtonAnswer:
                                id: answer1_1
                                on_press: root.answer1_pressed()

                            ButtonAnswer:
                                id: answer2_1
                                on_press: root.answer2_pressed()

                            ButtonAnswer:
                                id: answer3_1
                                on_press: root.answer3_pressed()

                            ButtonAnswer:
                                id: answer4_1
                                on_press: root.answer4_pressed()
                        Button:
                            id: propusk4
                            size_hint: 1, 0.3
                            on_press: root.propusk()
